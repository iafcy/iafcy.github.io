---
import { getCollection, render } from "astro:content";
import HeadingWithUnderline from "@components/HeadingWithUnderline.astro";
import mdComponent from "@components/md/components";
import { MapPin } from "lucide-react";

const education = await getCollection("education");

// sort by id for latest event to be on top
education.sort(function (a, b) {
    return -(Number(a.id) - Number(b.id));
});
---

<section class="mb-24">
    <HeadingWithUnderline text="Education" />
    <div>
        {
            education.map(async (event, index) => {
                const { Content } = await render(event);
                const isLast = index === education.length - 1;

                return (
                    <div class="flex gap-6 relative group">
                        <div class="flex flex-col items-center shrink-0">
                            <div class="w-4 h-4 rounded-full bg-mizugaki z-10" />
                            {!isLast && (
                                <div class="w-0.5 flex-1 bg-sumi/30 dark:bg-shironeri/30 my-1" />
                            )}
                        </div>

                        <div class={`flex-1 ${!isLast ? "pb-12" : "pb-0"}`}>
                            <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4 -mt-1">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        {event.data.title}
                                    </h3>
                                    <p class="text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2 text-sm">
                                        <MapPin className="h-4 w-4 shrink-0" />
                                        {event.data.location}
                                    </p>
                                </div>
                                
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-mizugaki/10 text-mizugaki border border-mizugaki/20 shadow-sm whitespace-nowrap tracking-wider self-start">
                                    {event.data.duration}
                                </span>
                            </div>

                            <div class="md">
                                <Content components={mdComponent} />
                            </div>
                        </div>
                    </div>
                );
            })
        }
    </div>
</section>

